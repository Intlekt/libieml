<html>
<head></head>
<body style="display: grid;grid-template-columns: 50% auto;">

    <textarea id="area"></textarea>
    <div id="result"></div>

    <!-- <script src='/build/binding/wasm/parser_wasm.js'></script> -->
    <script type="module">
        import wasmModule from "/build_wasm/binding/wasm/parser_wasm.js";
        
        const instance = wasmModule({
          onRuntimeInitialized: async () => {
            const parser = await instance;
            document.getElementById('area').addEventListener('change', (e)=>{
                console.log(e.target.value);
                const file_ids = new parser.StringList();
                file_ids.push_back("");

                const file_contents = new parser.StringList();
                file_contents.push_back(e.target.value);
                var res;
                try {
                    res = parser.parse_project(file_ids, file_contents);
                } catch (e) {
                    console.error("Parser error !")
                    return;
                }
                document.getElementById('result').textContent = res;
            })
          }
        });
    </script>
</body>
</html>